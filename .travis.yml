language: python

python:
  - "3.4"

install:
  - "sh ./.travis.sh"
  - "sudo apt-get install libqt4-dev"
  - "pip install PySide --no-index --find-links=http://content.dev.faforever.com/wheel/"
  - python ~/virtualenv/python${TRAVIS_PYTHON_VERSION}/bin/pyside_postinstall.py -install
  - "pip install pytest pytest-qt pytest-cov python-coveralls configobj mock quamash pygeoip pycrypto trueskill pyflakes"

before_script:
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"

script:
  - export QUAMASH_QTIMPL=PySide
  - py.test --cov-report term-missing --cov=src --cov=challonge --cov=games --cov=proxy --cov=stats --cov=steam --cov=teams --cov=tournament --cov=updater
  - pyflakes . || true

after_success:
  - coveralls
